@page "/guide"
@inject BreadcrumbProvider _bread
@using SimTECH.Pages.UserManual.Topics
@using SimTECH.Pages.UserManual.Topics.Race
@using SimTECH.Pages.UserManual.Topics.Setup

<PageTitle>Guide</PageTitle>

<MudContainer MaxWidth="MaxWidth.False" Class="mt-4">
    <MudGrid Spacing="1">
        <MudItem xs=12>
            <MudPaper Elevation="15" Height="75px" Class="d-flex flex-column justify-center align-center pa-4">
                <MudText Typo="Typo.h3">Guide</MudText>
            </MudPaper>
        </MudItem>
        <MudItem xs="3">
            <MudPaper Class="mud-height-full">
                <MudTreeView T="Type" Color="Color.Secondary" Hover="true" SelectedValueChanged="ActiveTopicChanged">
                    <MudTreeViewItem @bind-Expanded="@setupFolderExpanded"
                                     Text="Setup"
                                     Value="@(typeof(UnknownTopic))"
                                     Icon="@(setupFolderExpanded ? Icons.Custom.Uncategorized.FolderOpen : Icons.Custom.Uncategorized.Folder)">
                        <MudTreeViewItem Text="Drivers" Value="@(typeof(DriverTopic))" Icon="@Icons.Custom.FileFormats.FileImage" />
                    </MudTreeViewItem>
                    <MudTreeViewItem @bind-Expanded="@racingFolderExpanded"
                                     Text="Racing"
                                     Value="@(typeof(Racing))"
                                     Icon="@(racingFolderExpanded ? Icons.Custom.Uncategorized.FolderOpen : Icons.Custom.Uncategorized.Folder)">
                        <MudTreeViewItem Text="Distance" Value="@(typeof(Distance))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                        <MudTreeViewItem Text="Advance" Value="@(typeof(Advance))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                        <MudTreeViewItem Text="Reliability" Value="@(typeof(Reliability))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                        <MudTreeViewItem Text="Strategy" Value="@(typeof(Strategy))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                        <MudTreeViewItem Text="Overtaking" Value="@(typeof(Overtaking))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                        <MudTreeViewItem Text="Safety / Caution" Value="@(typeof(SafetyMoment))" Icon="@IconCollection.AlertTriangle" />
                        <MudTreeViewItem Text="Modifiers" Value="@(typeof(Modifiers))" Icon="@IconCollection.Polygon" />
                    </MudTreeViewItem>
                    <MudTreeViewItem Text="Glossary" Value="@(typeof(Glossary))" Icon="@Icons.Custom.FileFormats.FileExcel" />
                </MudTreeView>
            </MudPaper>
        </MudItem>
        <MudItem xs="9">
            <MudPaper Class="px-2 py-4 mud-height-full">
                <DynamicComponent Type="@TopicContent" />
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudContainer>

@code {
    Type TopicContent { get; set; } = typeof(Hello);

    bool setupFolderExpanded;
    bool racingFolderExpanded;

    protected override void OnInitialized()
    {
        _bread.SetBreadcrumbs(new List<BreadcrumbItem>()
        {
            new BreadcrumbItem("Home", href: "/"),
            new BreadcrumbItem("Guide", href: "guide", disabled: true),
        });
    }

    void ActiveTopicChanged(Type activeTopic)
    {
        TopicContent = activeTopic;
    }

    internal class GuidePage
    {
        public string Title { get; set; } = "[Unknown]";
        public string Icon { get; set; } = IconCollection.Pyramid;
        public List<GuidePage> Children { get; set; } = new();
    }
}
